# ============================================================
# SecureShield DRM — Environment Variables Reference
# ============================================================
# Copy this file to .env and fill in your values.
# NEVER commit .env to version control.
#
# Minimum required for local development:
#   DATABASE_URL, ADMIN_API_KEY, OFFLINE_TOKEN_SECRET,
#   VAULT_TOKEN_SECRET, VAULT_MASTER_KEY, SUPER_ADMIN_KEY
# ============================================================


# ── Database ─────────────────────────────────────────────────
# SQLite (local dev / tests):
#   sqlite+aiosqlite:///./drm.db
# PostgreSQL (production):
#   postgresql+asyncpg://user:password@host:5432/drm
DATABASE_URL=postgresql+asyncpg://drm_user:change_me@localhost:5432/drm


# ── Authentication Secrets ───────────────────────────────────
# Random string used to authenticate admin API requests.
# Minimum 32 characters. Rotate with zero-downtime by deploying
# with the new value — all active clients will need to update.
ADMIN_API_KEY=

# HS256 JWT signing secret for offline tokens.
# MUST be >= 32 bytes. Must differ from ADMIN_API_KEY.
OFFLINE_TOKEN_SECRET=

# HS256 JWT signing secret for vault access tokens.
# MUST be >= 32 bytes. Must differ from OFFLINE_TOKEN_SECRET.
VAULT_TOKEN_SECRET=

# Super-admin key for /superadmin/* endpoints (tenant provisioning).
# Keep this separate from ADMIN_API_KEY — it's a higher-privilege credential.
SUPER_ADMIN_KEY=

# 32-byte random key used to wrap per-file AES-256-GCM encryption keys.
# Generate with: python -c "import secrets,base64; print(base64.b64encode(secrets.token_bytes(32)).decode())"
# Rotating this key requires re-encrypting all vault files.
VAULT_MASTER_KEY=


# ── Redis ────────────────────────────────────────────────────
# Used for session revocation and real-time SSE pub/sub.
# Managed Redis examples:
#   AWS ElastiCache: redis://cluster.abc123.cache.amazonaws.com:6379/0
#   Upstash:         redis://default:token@host.upstash.io:6379
REDIS_URL=redis://localhost:6379/0


# ── AWS S3 (Content Vault) ───────────────────────────────────
# Credentials for the S3 bucket that stores encrypted vault files.
# For local dev, use MinIO or set S3_ENDPOINT_URL to http://localhost:9000.
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_DEFAULT_REGION=us-east-1

# S3 bucket name (must already exist with appropriate IAM policy)
S3_BUCKET=secureshield-vault

# Optional: override S3 endpoint for local MinIO or other S3-compatible stores
# S3_ENDPOINT_URL=http://localhost:9000


# ── Stripe Payments ──────────────────────────────────────────
# Get these from https://dashboard.stripe.com/apikeys
# Test keys start with sk_test_ and whsec_ (safe for staging)
STRIPE_API_KEY=sk_test_...
STRIPE_WEBHOOK_SECRET=whsec_...


# ── CORS ────────────────────────────────────────────────────
# Comma-separated list of allowed frontend origins.
# Whitespace around commas is stripped automatically.
CORS_ORIGINS=http://localhost:3000


# ── Tunable Limits (optional — defaults shown) ───────────────
# Maximum file size accepted for vault uploads (megabytes)
# MAX_UPLOAD_MB=500

# Disable rate limiting — useful for local dev; NEVER set in production
# RATE_LIMIT_ENABLED=true


# ── LLM Council — AI Anomaly Enrichment (optional) ───────────
# Powered by OpenRouter (https://openrouter.ai).
# When set, GET /admin/anomalies/enriched runs a 3-stage LLM council
# (First Opinions → Peer Review → Chairman Synthesis) over the top
# statistical anomaly findings.  Leave empty to disable the feature.
OPENROUTER_API_KEY=

# Council member models queried in parallel during Stage 1 and Stage 2.
# Any OpenRouter model ID is accepted.  Cheaper/faster models work well here.
# COUNCIL_MODELS=["openai/gpt-4o-mini","anthropic/claude-haiku-4-5-20251001","google/gemini-flash-1.5"]

# Chairman model that synthesizes the final verdict from all council opinions.
# A more capable model is recommended here.
# CHAIRMAN_MODEL=anthropic/claude-sonnet-4-6

# How long (seconds) to cache a council verdict in Redis.  Default: 1800 (30 min).
# COUNCIL_CACHE_TTL=1800
